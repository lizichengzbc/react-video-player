# React Video Player 使用指南

## 安装

```bash
npm install @lzc-org/react-video-player
# 或
pnpm add @lzc-org/react-video-player
# 或
yarn add @lzc-org/react-video-player
```

## 基础使用

### 1. 导入组件

```typescript
import { VideoPlayer } from '@lzc-org/react-video-player';
import type { VideoSource, VideoPlayerConfig } from '@lzc-org/react-video-player';
```

### 2. 基本示例

```tsx
import React from 'react';
import { VideoPlayer } from '@lzc-org/react-video-player';
import type { VideoSource } from '@lzc-org/react-video-player';

const App: React.FC = () => {
  const videoSource: VideoSource = {
    url: 'https://example.com/video.mp4',
    type: 'video/mp4',
    title: '示例视频'
  };

  return (
    <div className="app">
      <VideoPlayer
        source={videoSource}
        width="100%"
        height="400px"
        autoPlay={false}
        controls={true}
      />
    </div>
  );
};

export default App;
```

### 3. HLS 流媒体播放

```tsx
import React from 'react';
import { VideoPlayer } from '@lzc-org/react-video-player';
import type { VideoSource, VideoPlayerConfig } from '@lzc-org/react-video-player';

const HLSExample: React.FC = () => {
  const hlsSource: VideoSource = {
    url: 'https://example.com/playlist.m3u8',
    type: 'application/x-mpegURL',
    title: 'HLS 直播流'
  };

  const config: VideoPlayerConfig = {
    hls: {
      enableWorker: true,
      lowLatencyMode: true
    }
  };

  return (
    <VideoPlayer
      source={hlsSource}
      config={config}
      width="100%"
      height="500px"
      autoPlay={true}
    />
  );
};

export default HLSExample;
```

### 4. YouTube 视频播放

```tsx
import React from 'react';
import { VideoPlayer } from '@lzc-org/react-video-player';
import type { VideoSource } from '@lzc-org/react-video-player';

const YouTubeExample: React.FC = () => {
  const youtubeSource: VideoSource = {
    url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
    type: 'video/youtube',
    title: 'YouTube 视频'
  };

  return (
    <VideoPlayer
      source={youtubeSource}
      width="100%"
      height="400px"
      controls={true}
    />
  );
};

export default YouTubeExample;
```

### 5. 社交功能集成

```tsx
import React from 'react';
import { VideoPlayer } from '@lzc-org/react-video-player';
import type { VideoSource, SocialActions } from '@lzc-org/react-video-player';

const SocialExample: React.FC = () => {
  const videoSource: VideoSource = {
    url: 'https://example.com/video.mp4',
    type: 'video/mp4',
    title: '社交视频示例'
  };

  const socialActions: SocialActions = {
    onLike: () => console.log('点赞'),
    onShare: () => console.log('分享'),
    onComment: () => console.log('评论'),
    onSubscribe: () => console.log('订阅')
  };

  return (
    <VideoPlayer
      source={videoSource}
      socialActions={socialActions}
      width="100%"
      height="400px"
      showSocialActions={true}
    />
  );
};

export default SocialExample;
```

## 高级配置

### 错误处理

```tsx
import React from 'react';
import { VideoPlayer } from '@lzc-org/react-video-player';
import type { VideoSource } from '@lzc-org/react-video-player';

const ErrorHandlingExample: React.FC = () => {
  const handleError = (error: Error) => {
    console.error('视频播放错误:', error);
    // 自定义错误处理逻辑
  };

  const handleRetry = () => {
    console.log('重试播放');
    // 重试逻辑
  };

  return (
    <VideoPlayer
      source={{
        url: 'https://example.com/video.mp4',
        type: 'video/mp4',
        title: '错误处理示例'
      }}
      onError={handleError}
      onRetry={handleRetry}
      maxRetries={3}
      retryDelay={2000}
    />
  );
};

export default ErrorHandlingExample;
```

### 自定义样式

```tsx
import React from 'react';
import { VideoPlayer } from '@lzc-org/react-video-player';
import './custom-video-player.css';

const CustomStyledExample: React.FC = () => {
  return (
    <div className="custom-video-container">
      <VideoPlayer
        source={{
          url: 'https://example.com/video.mp4',
          type: 'video/mp4',
          title: '自定义样式示例'
        }}
        className="custom-video-player"
        width="100%"
        height="400px"
      />
    </div>
  );
};

export default CustomStyledExample;
```

## API 参考

### VideoPlayer Props

| 属性 | 类型 | 默认值 | 描述 |
|------|------|--------|------|
| source | VideoSource | - | 视频源配置 |
| width | string \| number | '100%' | 播放器宽度 |
| height | string \| number | '400px' | 播放器高度 |
| autoPlay | boolean | false | 自动播放 |
| controls | boolean | true | 显示控制栏 |
| muted | boolean | false | 静音播放 |
| loop | boolean | false | 循环播放 |
| poster | string | - | 封面图片 |
| config | VideoPlayerConfig | - | 播放器配置 |
| socialActions | SocialActions | - | 社交功能配置 |
| showSocialActions | boolean | false | 显示社交按钮 |
| onError | (error: Error) => void | - | 错误回调 |
| onRetry | () => void | - | 重试回调 |
| maxRetries | number | 3 | 最大重试次数 |
| retryDelay | number | 2000 | 重试延迟(ms) |

### VideoSource 接口

```typescript
interface VideoSource {
  url: string;           // 视频URL
  type: string;          // MIME类型
  title?: string;        // 视频标题
  poster?: string;       // 封面图片
  subtitles?: Subtitle[]; // 字幕轨道
}
```

### VideoPlayerConfig 接口

```typescript
interface VideoPlayerConfig {
  hls?: HlsConfig;       // HLS配置
  dash?: DashConfig;     // DASH配置
  youtube?: YouTubeConfig; // YouTube配置
  vimeo?: VimeoConfig;   // Vimeo配置
  webrtc?: WebRTCConfig; // WebRTC配置
}
```

## 支持的视频格式

- **原生HTML5**: MP4, WebM, OGV
- **HLS**: M3U8 流媒体
- **DASH**: MPD 自适应流
- **YouTube**: YouTube视频链接
- **Vimeo**: Vimeo视频链接
- **WebRTC**: 实时流媒体

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+
- iOS Safari 12+
- Android Chrome 60+

## 注意事项

1. **HTTPS要求**: 某些功能（如自动播放）需要在HTTPS环境下使用
2. **CORS配置**: 跨域视频资源需要正确配置CORS头
3. **移动端限制**: iOS Safari对自动播放有严格限制
4. **性能优化**: 大型视频文件建议使用流媒体格式（HLS/DASH）

## 故障排除

### 常见问题

1. **视频无法播放**
   - 检查视频URL是否有效
   - 确认MIME类型设置正确
   - 验证CORS配置

2. **HLS流无法加载**
   - 确保浏览器支持HLS
   - 检查网络连接
   - 验证M3U8文件格式

3. **自动播放失败**
   - 设置muted属性为true
   - 确保在HTTPS环境下
   - 检查浏览器自动播放策略

### 调试模式

```tsx
// 启用调试日志
const config: VideoPlayerConfig = {
  debug: true,
  hls: {
    debug: true
  }
};
```

## 更多示例

查看 `examples` 目录获取更多使用示例和最佳实践。